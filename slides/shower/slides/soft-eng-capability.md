% 谈谈工程师忽视的软件开发能力
% Tyr Chen
% Dec 13th, 2017

## 引子 {.slide}

> 一个月前我发了个 tubi tv 的招聘贴，讲到我们的广告系统用 scala 撰写。后台于是一下子涌来好多留言：啊啊啊你们为什么要用scala 开发广告系统？为什么不用 erlang？为什么不用 C++？scala 合适吗？编译那么慢？效率也不高？akka 还是偷师的 erlang/OTP？...

## 讨论 {.slide}

* 程序员容易陷入无所谓的对语言本身的争执上去
    - 语言的确有适合哪些应用场景的问题，生态圈的问题，撰写快慢的问题
* 两三年工作经验的工程师往往会遇到一个瓶颈 - 过于关注于某个语言和某种技术本身而忽视了系统层面的修为
* 软件开发是一个系统性的工程，语言占比有多大？你写的代码的占比有多大？
* 软件是为什么服务？business！你又了解多少和 business 有关的知识呢？

## 软件系统 {.slide .shout}

## 什么是软件系统？ {.slide}

> A software system is a system on intercommunicating components based on software forming part of a computer system (a combination of hardware and software). It "consists of a number of __separate programs__, __configuration files__, which are used to set up these programs, system documentation, which describes the structure of the system, and user documentation, which explains how to use the system"

## 什么是软件系统？ {.slide}

![](images/software_system.jpg){height=500px}

## 软件系统的演进 {.slide}

* 婴儿期：PoC / MVP，本地运行，只关注成功路径。问题：它是否可行？
* 少儿期：开始面对真实世界，加入错误处理，关注健壮性。问题：它是否有价值？
* 青春期：日志，错误报告，安全，部署，更多商业逻辑。问题：它是否能为更多的客户带来价值？
* 成人期：性能，CI/CD，监控，报警，统计分析，自动伸缩，自动恢复。问题：它是否能持续为客户带来价值，并立足于商业竞争？
* 消亡期

## 最有意思：婴儿期 (build) {.slide .shout}

## 婴儿期 {.slide}

* MVP
* 从 0 到 1 的成就感
* 没有脏活累活（错误处理，部署，监控等），全是新鲜体验
* 就是写代码，没那些乌七八糟的事

## 最无趣：成人期 (change/maintain) {.slide .shout}

## 成人期 {.slide}

* 无穷无尽的线上问题（还要回头补充 UT，IT，和 metrics 防止 regression）
* 重压之下的问题解决能力
* 很多跟代码无关的事情（业务挂了，你要写个事后分析吧，性能降了，你要分析和解决吧，等等）

## 软件开发就像育儿 {.slide}

* 要有持之以恒的耐心来不断应对变化
* 善于观察，思考对策
* 不断总结累积共性
* 孩子最终要从童话世界中走出，面对现实世界的厮杀

## 什么样的能力可以从一套系统带入到下一套系统？{.slide .shout}

## 一些问题 {.slide}

一个项目结束后，喘口气，找个可以独处的时间，问问自己：

* 这个项目我学习到了哪些我没接触到的东西？我能将他们应用在下一个项目中么？
* 我在项目中，哪些事情或者决策能够做得更好？
* 如果让我从零到一开发这个项目，我还缺失哪些知识和技能？

## 系统能力 {.slide}

* 和具体的功能无关 —— 如何使用各种工具和资源，建立一套体系，让软件能够正常 __运行__ 和 __演进__
* 收集数据的能力，以及分析数据的能力
* 快速应对问题，进行决策和解决问题的能力
* 万金油 —— 什么都「略懂」

## 业务知识 {.slide}

* 如何获取用户？如何留住用户？如何让已有的用户升级为 power user？
* 公司如何赚钱？公司如何花钱？用户获取的费用如何？用户的 life time value 怎样？
* 谁是我们的竞争对手？我们在行业间的竞争优势是什么？
* 我所构建的系统，行业上通行的做法是什么？

## 系统能力 {.slide .shout}

## 系统能力细分 {.slide}

* 综合技术能力
    * 软件的部署
    * 系统架构
    * 数据架构
    * 监控和报警
* 数据能力
    * 收集数据的能力
    * 分析数据的能力
* 综合能力
    * 快速决策和解决问题的能力
    * 什么都略懂一些
    * 责任心：有担当
    * 敢为人先：不要推辞那些你没准备好的事情

## 软件的部署 {.slide}

* 部署不仅仅是 devOps 的事
* 项目是如何部署的？服务之间的网络架构是什么样子？数据如何流转？
* 方案：
    * 手工部署：ssh & rsync & restart
    * 脚本部署：fabric / ansible / puppet / chef
    * 打包部署：docker，AMI

## 系统架构 {.slide}

* 项目的整体架构是什么？
* 如果有 framework，framework 和 app 之间是如何解耦的，依赖是如何注入的？
* 处理一个请求或者任务的 pipeline 是什么样子的？（能不能在白板上画出来）
* 服务的 QoS 如何保证？是否使用了队列？如何调度？
* 系统是怎么运行的？都有什么样的依赖，为什么要有这样的依赖？
* 日志监控报警都是怎么处理的？
* 系统的哪个部分不够合理？如果将系统中的某个部分替换，可以怎么处理？

## 数据架构 {.slide}

* 用户在 app 中的行为，哪怕是 idle 的行为，都应该收集
    * 求全，想清楚，最好一步到位，至少一年内不会因为少记录了什么而懊悔
* 从用户端收集来的 event 应该采用什么样的格式？哪些 context 必须具备？
    * 记叙文三要素：时间地点人物。发生了什么事，上下文是什么
* 不同平台搜集上来的数据如何统一（是否有必要统一）？
    * web 的 click 和 iOS 的 touch 是否要统一？如何统一？
* event 存储在何处？如何 aggregate？
* aggregate 的各种结果存储在何处？如何查询？如何可视化？

## 监控和报警 {.slide}

* 避免自己成为瞎子和聋子
* 错误日志如何收集？
* 哪些关键路径上的 data point 我们要发送到监控系统？
    * 例1：某个 API 的调用次数本周比上周减少了 20%
    * 例2：某个服务的响应时间突然从 20ms 提升到了 50ms
* 哪些 metrics 的改变我们要报警？
    * 例3：客户端新发的版本表现不正常
    * 例4：5xx 突然增多

## 收集数据的能力 {.slide}

* 什么数据值得收集？（公司在收集些什么数据？为什么？有没有可以改进的地方？）
* 收集到的数据流向了什么系统？为什么？
* 数据是如何处理和聚合的？（是 realtime 还是 batch？为什么？有没有可以改进的地方？）
* 聚合后的数据怎么存储？
* 数据是否能够方便地查询？可视化？

## 分析数据的能力 {.slide}

* 如何读懂各个指标？
* 如何看待某个指标的增长？（同比/环比？）
    * 例1：一个新版本导致 response time 降低
* 如何通过对比多个指标寻找潜在的问题？
    * 例2：对比同一时间点上的 metrics 寻找差异
* 如何通过数据的异常发现问题？
    * 例3：广告的 impression 的异常

## BTC {.slide}

![](images/btc.jpg){width=960px}

## 快速决策和解决问题 {.slide}

* 软件开发的本质是：make decision
* 决策：将来自多方的信息汇总到一起产生一个合理的解决方案
  - 注意累积你个人的 KB
  - 要勇于决策，勇于行动
* 解决问题，尤其是线上问题不一定要完美的方案
  - 跟时间赛跑
  - workaround 往往更佳

## 什么都略懂一些 {.slide}

* 很多别人的知识和经验，如果多问些为什么，能够转化为你自己的
* 不要把自己桎梏在前端 / 后端 / devOps 这些角色，要多学习其他领域
* 灰色地带的知识和经验往往具有很大的价值（Only you）
  - 你是代码写得好还知道如何表达的
  - 你是系统层开发很6，还对业务有深入思考的
  - 你是前端产品开发很棒，还懂得如何做数据分析的

## 责任心：有担当 {.slide}

* proud to be the owner & eat your own dog shit
* 代码在线上出问题不可怕，可怕的是想法掩盖事实
* 总结经验教训，查漏补缺，UT/IT/metrics/alert，一个都不放过
* 不管是否自己 oncall，出了问题第一时间投入进去不解决不罢休
* 把自己当成用户，想象她们的绝望

## 敢为人先：不要推辞那些你没准备好的事情 {.slide}

* 线上的服务总是会出各种各样让人崩溃的问题
* 你可以选择逃避，让有经验的人去面对
* 但更应该直面，负起责任，寻找解决方案
* 这是能让你最快成长的、最快累积系统知识的途径

## 多学些业务知识 {.slide .shout}

## 程序员的定位 {.slide}

* 商业的本质是赚钱
* 离钱越近的职位对公司而言越重要
* 你离钱有多近？
* 你知道公司怎么赚钱么？

## 每个人都应该知道的业务知识(1) {.slide}

* 公司是如何获取用户？
* 如何留住用户？
* 如何让已有的用户升级为 power user？

## 每个人都应该知道的业务知识(2) {.slide}

* 公司或者部门如何赚钱？（每年赚多少钱？我的业务部门赚多少钱？占比？）
* 公司或者部门如何花钱？
* 用户获取的费用如何？
* 用户的 life time value 怎样？

## 每个人都应该知道的业务知识(3) {.slide}

* 谁是我们的竞争对手？
* 我们在行业间的竞争优势是什么？
* 主要竞争对手的系统有什么特色？

## 每个人都应该知道的业务知识(4) {.slide}

* 构建我们所做的业务，行业上通行的方式是什么？
* 这个行业使用的协议，规范，接口我是否都已经了解？
* 这个行业和其上下游的关系是什么样的？

## 你在为你的未来累积能力 {.slide .shout}
